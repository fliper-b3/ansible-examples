server {
    listen    80;
    server_name billing.expertoption.com;
    return 301 https://$host$request_uri;
}

server {
    listen 443 ssl;
    server_name billing.expertoption.com;

    access_log  /var/log/nginx/billing-access.log advanced;
    error_log   /var/log/nginx/billing-error.log;

    include conf.d/expertoption.com.ssl.inc;
    include conf.d/gzip.inc;

    root /home/expert/wserver/rdv6088/web/billing;

    set_real_ip_from 10.0.0.0/8;
    real_ip_header X-Forwarded-For;
    real_ip_recursive on;

    location  /web {
        add_header 'Access-Control-Allow-Origin' '*';
        add_header 'Access-Control-Allow-Credentials' 'true';
        add_header 'Access-Control-Allow-Methods' 'GET, POST, OPTIONS';
        add_header 'Access-Control-Allow-Headers' 'DNT,X-CustomHeader,Keep-Alive,User-Agent,X-Requested-With,If-Modified-Since,Cache-Control,Content-Type';

        proxy_pass  http://app-gunicorn;
        proxy_http_version 1.1;
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection "upgrade";
        proxy_set_header Host $host;
        proxy_set_header X-Forwarded-Proto $scheme;
        proxy_set_header X-Forwarded-For $remote_addr;
        proxy_set_header X-Forwarded-Port $server_port;
        proxy_set_header X-Request-Start $msec;

        client_max_body_size 100m;
    }

    #location ~ \.php$ {
    #    fastcgi_split_path_info ^(.+?\.php)(/.*)$;
    #    set $path_info $fastcgi_path_info;
    #    fastcgi_param PATH_INFO $path_info;
    #    fastcgi_index index.php;
    #    include fastcgi.conf;
    #    fastcgi_pass nodsg-billing-php;
    #}
    location = /favicon.ico {
        alias /home/expert/apps/site-ng/dist/client/favicon.ico;
    }
}
